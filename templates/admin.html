<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>Admin - Loja</title>

    <!-- Bootstrap -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
      rel="stylesheet"
    >
</head>
<body class="bg-light">

<div class="container mt-4">

    <!-- STATUS DA LOJA -->
    <div class="card shadow-sm mb-3">
        <div class="card-body">
            <h2 class="card-title mb-3">üõ†Ô∏è Painel da Dona</h2>

            {% if loja_aberta %}
                <div class="alert alert-success d-flex justify-content-between align-items-center flex-wrap">
                    <span>‚úÖ Loja est√° <strong>ABERTA</strong></span>
                    <a href="/admin/toggle_loja" class="btn btn-danger btn-sm mt-2 mt-md-0">
                        Fechar Loja
                    </a>
                </div>
            {% else %}
                <div class="alert alert-danger d-flex justify-content-between align-items-center flex-wrap">
                    <span>üö´ Loja est√° <strong>FECHADA</strong></span>
                    <a href="/admin/toggle_loja" class="btn btn-success btn-sm mt-2 mt-md-0">
                        Abrir Loja
                    </a>
                </div>
            {% endif %}

            <a href="/" class="btn btn-outline-secondary btn-sm mt-2">
                ‚Üê Voltar para o site
            </a>
        </div>
    </div>

    <!-- ADICIONAR PRODUTO -->
    <div class="card shadow-sm mb-3">
        <div class="card-body">
            <h4 class="mb-3">‚ûï Adicionar Produto</h4>

            <form method="POST" action="/admin/add_produto" enctype="multipart/form-data" class="row g-3">

                <div class="col-12 col-md-6">
                    <input
                        type="text"
                        name="nome"
                        class="form-control"
                        placeholder="Nome do produto"
                        required
                    >
                </div>

                <div class="col-12 col-md-4">
                    <input
                        type="number"
                        step="0.01"
                        name="preco"
                        class="form-control"
                        placeholder="Pre√ßo (R$)"
                        required
                    >
                </div>

                <div class="col-12">
                    <input
                        type="file"
                        name="imagem"
                        class="form-control"
                        accept="image/*"
                    >
                </div>

                <div class="col-12 col-md-2 d-grid">
                    <button class="btn btn-primary">
                        Adicionar
                    </button>
                </div>

            </form>
        </div>
    </div>

    <!-- LISTA DE PRODUTOS -->
    <div class="card shadow-sm mb-3">
        <div class="card-body">
            <h4 class="mb-3">üì¶ Produtos Cadastrados</h4>

            {% if produtos %}
            <div class="table-responsive">
                <ul class="list-group">
                    {% for p in produtos %}
                        <li class="list-group-item d-flex justify-content-between align-items-center flex-wrap">

                            <div class="d-flex align-items-center gap-3 flex-wrap">
                                {% if p['imagem'] %}
                                    <img
                                      src="{{ url_for('static', filename='uploads/' ~ p['imagem']) }}"
                                      class="img-fluid rounded"
                                      style="max-width: 60px; height: auto;"
                                      alt="{{ p['nome'] }}"
                                    >
                                {% else %}
                                    <img
                                      src="{{ url_for('static', filename='uploads/sem-imagem.png') }}"
                                      class="img-fluid rounded opacity-50"
                                      style="max-width: 60px; height: auto;"
                                      alt="Sem imagem"
                                    >
                                {% endif %}

                                <div>
                                    <strong>{{ p['nome'] }}</strong><br>
                                    <small class="text-muted">
                                        R$ {{ "%.2f"|format(p['preco']) }}
                                    </small>
                                </div>
                            </div>

                            <a
                              href="/admin/remover_produto/{{ p['id'] }}"
                              class="btn btn-outline-danger btn-sm mt-2 mt-md-0"
                              onclick="return confirm('Deseja remover este produto?')"
                            >
                                ‚ùå Remover
                            </a>

                        </li>
                    {% endfor %}
                </ul>
            </div>
            {% else %}
                <p class="text-muted">Nenhum produto cadastrado.</p>
            {% endif %}
        </div>
    </div>

    <!-- LOGOUT -->
    <div class="text-center mt-4">
        <a href="/admin/logout" class="btn btn-link text-danger">
            Sair do admin
        </a>
    </div>

</div>

</body>
</html>
